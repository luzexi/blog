<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta content="unity3d 高级编程 主程 shader Property shaderlab vertex fragment" name="description">


  <title>
    
      《Unity3D高级编程之进阶主程》第七章，Shader(二) - Property
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css?version=20180701">
  <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"> -->

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

  	<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          技术人生
        </a>
      </h1>
      <p class="lead">漫漫人生,记录点滴技术,始于2013</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      <a class="sidebar-nav-item" href="/书籍著作/index.html">书籍著作</a>
      <a class="sidebar-nav-item" href="/Unity3D/index.html">Unity3D</a>
      <a class="sidebar-nav-item" href="/游戏通用模块/index.html">游戏通用模块</a>
      <a class="sidebar-nav-item" href="/前端技术/index.html">前端技术</a>
      <a class="sidebar-nav-item" href="/后端技术/index.html">后端技术</a>
      <a class="sidebar-nav-item" href="/其他技术/index.html">其他技术</a>
      <a class="sidebar-nav-item" href="/金融投资/index.html">金融投资</a>
      <a class="sidebar-nav-item" href="/life/index.html">Life</a>

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/Util-page.html">常用页面工具</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about.html">About Me</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/engineer-shopping.html">程序员必需品</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/friendlink.html">友情链接</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
      
      
      <a class="sidebar-nav-item" href="https://github.com/luzexi">GitHub project</a>
      <a href="http://www.luzexi.com/assets/feed.xml">RSS feed</a>
      <!-- <span class="sidebar-nav-item">Currently v2.1.0</span> -->
    </nav>

    <p>&copy; 2018. All rights reserved.</p>
    <p>浙ICP备13028172号-1</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">《Unity3D高级编程之进阶主程》第七章，Shader(二) - Property</h1>
  <span class="post-date">07 Aug 2018</span>
  <h3>编写Shader的几种方式</h3>

<p>着色器部分的编写是客户端的精髓，如果说架构表现了逻辑整合能力，算法展现了数学能力，那么着色器编写展现了表现能力，在游戏项目中三者缺一不可，特别是作为主程或者说资深的U3D人员来说是极其重要的。</p>

<p>===</p>

<p>Unity3D使用了自己创造的语言命名为ShaderLab来编写图形Shader。在ShaderLab里模拟了类似CgFX和Direct3D Effects(.FX)的语言，从而可以编写绝大部分的图形渲染材质。</p>

<p>ShaderLab编写的Shader属性会在Unity的材质球编辑器中显示，ShaderLab可以实现基于多种目标硬件的能力，并且每个ShaderLab完全能够编写图形硬件渲染状态，以及使用vertex和fragment编程。Shader的编写是基于高级Cg/HLSL编程语言基础上的。</p>

<p>下面几节中，我们会详细的讲解，如何用ShaderLab去写Unity Shader，包括Surface Shader, fixed-function Shader,vertex和fragment的Shader编程。</p>

<p>Shader编程需要一些基本的OpenGL或Direct3D渲染状态的知识，还有一些HLSL,Cg,GLSL或者Metal Shader编程语言的知识。如果并没有掌握也没有关系，我们将以通俗易懂的语言解释大部分的图形渲染知识。</p>

<p>编写Unity Shader的几种形式：</p>

<h6>1，fixed-function，这种形式的Shader使用了Unity自己编制的比较简单的图形语言来编写Shader。</h6>

<p>编写完毕后在导入和编译时，Unity内部会将这个fixed-function形式的代码，转化成vertex和fragment编程形式。</p>

<p>因为fixed-function形式编写起来比较简单易懂，所以一些简单的Shader可以用fixed-function来编写，可以节省很多学习底层图形学的时间也增加了不少效率。缺点是，功能并不是很全，复杂一点的或者说个性化点的Shader就需要用其他的方式实现。</p>

<h6>2，Surface shaders 是Unity建立的一种新的Shader编程方式，目的是让Shader编程更加简单。</h6>

<p>在Surface Shader里没有任何的自定义语言，贴图，或者变量。它会生成所有你需要手写的代码，让你专注于编写渲染部分的规则，其中一个特色是Surface Shader不需要写Pass，它会自动帮你编译成为多个你需要的多个Pass。</p>

<p>Surface Shader编译器最终会将所有代码转换成vertex-fragment类型的Shader。</p>

<h6>3，vertex and fragment shaders是ShaderLab Shader包含的几种不同的编写方式中最最底层的编码方式，它使用的HLSL语言编程，我们称之为底层硬件着色器着色编程。</h6>

<p>使用vertex-fragment方式只是ShaderLab的理念中的其中一部分，fixed-function和suface都是其理念的一部分，并不一定说要使用vertex-fragment底层的才好，其他方式也同样能帮助你节省很多时间。</p>

<p>比如你想对灯光作用进行着色编程，你完全可以使用Surface Shader去实现你的想法，如果只想对贴图上色和混合，你使用fixed-function更为简单省事，如果你想对顶点颜色，或对顶点坐标进行更改，或者片元的着色需要更改等一些更复杂的图形操作，那你就需要使用vertex-fragment Shader进行编程。</p>

<p>针对不同的复杂度，不同的项目，不同领域的着色渲染，我们完全可以选择不同的方式来编写Shader。</p>

<p>无论你用哪种方式编写Shader，其实都是在ShaderLab语言结构下的，前面说过ShaderLab是Unity指定的组织Shader的官方编程语言，所以在Unity编写Shader首先要学会如何使用ShaderLab。</p>

<p>了解了基本的ShaderLab语言结构和语法，再去学习surface和vertex-fragment就会相对比较容易。而fixed-function是完全基于ShaderLab语法结构编写的，所以fixed-function形式的写法完全可以参照ShaderLab的使用方法来编写。</p>

<h3>ShaderLab语法与参数详解</h3>

<p>我们需要着重介绍下ShaderLab的格式，Unity3D中所有的Shader编程方式都是基于ShaderLab的，因此ShaderLab语法是基础。</p>

<h6>Shader的开头</h6>

<p>“Shader” 是Shader文件的根命令。每个文件必须定义一个且只有一个Shade命令，它可以定义一个Shader的名字，是一个Shader的开头。</p>

<p>在“Shader”里面你才可以表达有哪些属性，有哪些渲染模式被开启和关闭，有多少条渲染管线等等那些你需要的定义以及变化。</p>

<p>格式：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Shader “name”
    {
        [Properties属性]
        Subshaders
        [Fallback]
        [CustomEditor]
    }
</code></pre></div>
<p>定义了一个Shader后，Shader的Name就会出现在Unity编辑器的材质球视窗的Shader列表里，可供你选择。Shader中定义的属性，供Shader计算使用，并且这些属性会显示在材质球编辑器的视窗中。</p>

<script type="text/javascript">
    if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent))
    { //移动端
        /*mobile-20:5*/
        var cpro_id = "u3493987";
        document.write("\<script type=\"text\/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/cm.js\"\>\<\/script\>");
    }
    else
    {
         /*700*200信息流*/
        var cpro_id = "u3469788";
        document.write("\<script type=\"text/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/c.js\"\>\<\/script\>");
    }
</script>

<h6>Properties属性</h6>

<p>Shader中可以自己定义一些属性用来在后面的渲染计算中使用。比如数字，颜色，方向，坐标，贴图。</p>

<p>Properties格式：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Properties
    {
        PropertyName1 (“display name名字”，type类型) = value默认值
        PropertyName2 (“display name名字”，type类型) = value默认值
        PropertyName3 (“display name名字”，type类型) = value默认值
        …
    }
</code></pre></div>
<p>Properties属性格式需要中括号框起来，大括号内都是属性的详细说明。</p>

<p>其中PropertyName和 display name是不一样的，Property Name是属性的真正名字，可以用来通过材质球才程序中更改和赋值，或者在后面的渲染计算中使用。而display name 只是在编辑器中显示该属性名的名字，没有其他用途。</p>

<p>下面举例来说明各种类型的书写方式。</p>

<p>数字</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Name属性名 (“display name显示名”, Range(最小值,最大值)) = 默认值

    上述属性块定义了一个数字，起始有一个默认值，该值可以在最大值和最小值范围内，不得超出最大和最小值，定义后可以在材质球的编辑器中滑动的来选择值的大小。

    Name属性名 (“display name显示名”, Float) = 默认值

    上述属性块定义了一个浮点数数值，具有一个默认值，同样定义后，可以在材质球的编辑器中输入浮点数来重新赋值。

    Name属性名 (“display name显示名”, Int) = 默认值

    上述属性块定义了一个整数数值，具有一个默认值，同样定义后，可以在材质球的编辑器中输入整数来重新赋值。
</code></pre></div>
<p>颜色</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Name属性名 (“display name显示名”, Color) = (R,G,B,A)

    上述属性块定义了一个颜色，具有一个RGBA(红，绿，黑，alpha)的默认值，定义后可以在材质球的编辑器中选择一个颜色来重新赋值。
</code></pre></div>
<p>方向和坐标</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Name属性名 (“display name显示名”, Vector) = (0,0,0,0)

    上述属性块定义了一个方向或者坐标，具有一个默认值，定义后可以在材质球的编辑器中填写4个值来重新赋值。
</code></pre></div>
<p>贴图</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Name属性名 (“display name显示名”, 2D) = “white” {}

    上述属性块定义了一个2D贴图，具有一个纯白色的默认贴图，定义后可以在材质球的编辑器中选择新的贴图来重新赋值。

    Name属性名 (“display name显示名”, Cube) = {}

    上述属性块定义了一个Cube镜面盒子，空的默认值，定义后可以在材质球的编辑器中选择新的Cube镜面盒子来重新赋值。

    Name属性名 (“display name显示名”, 3D) = “white” {}

    上述属性块定义了一个3D贴图，具有一个纯白色的默认贴图，定义后可以在材质球的编辑器中选择新的3D贴图来重新赋值。这个3D Texture不是普通的3D模型的贴图，而是图像后处理形成的3D颜色校正效果贴图。3D Texture由脚本或者着色器产生，而非手绘制造的。可参考Unity API中的Texture3D类。
</code></pre></div>
<p>综合上面的表述，我们可以制作一个全属性Properties例子。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Properties</span>
<span class="o">{</span>
    <span class="n">_Scale</span> <span class="o">(</span><span class="s">&quot;Scale&quot;</span><span class="o">,</span> <span class="n">Range</span> <span class="o">(</span><span class="mf">0.02</span><span class="o">,</span><span class="mf">0.15</span><span class="o">))</span> <span class="o">=</span> <span class="mf">0.07</span>
    <span class="n">_PahLength</span><span class="o">(</span><span class="s">&quot;Path Length&quot;</span><span class="o">,</span> <span class="n">Float</span><span class="o">)</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">_OrderNumber</span><span class="o">(</span><span class="s">&quot;Order Number&quot;</span><span class="o">,</span> <span class="n">Int</span><span class="o">)</span> <span class="o">=</span> <span class="mi">53</span>
    <span class="n">_RefrColor</span> <span class="o">(</span><span class="s">&quot;Refraction color&quot;</span><span class="o">,</span> <span class="n">Color</span><span class="o">)</span> <span class="o">=</span> <span class="o">(</span><span class="mf">0.34</span><span class="o">,</span> <span class="mf">0.85</span><span class="o">,</span> <span class="mf">0.92</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> 
    <span class="n">_Direction</span> <span class="o">(</span><span class="s">&quot;Direction&quot;</span><span class="o">,</span> <span class="n">Vector</span><span class="o">)</span> <span class="o">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mf">4.5</span><span class="o">,</span> <span class="mf">1.2</span><span class="o">,</span> <span class="mf">3.3</span><span class="o">)</span> 
    <span class="n">_RefractionTex</span> <span class="o">(</span><span class="s">&quot;Environment Refraction&quot;</span><span class="o">,</span> <span class="mf">2D</span><span class="o">)</span> <span class="o">=</span> <span class="s">&quot;white&quot;</span> <span class="o">{}</span>
    <span class="n">_RefractionMap</span> <span class="o">(</span><span class="s">&quot;Refraction Map&quot;</span><span class="o">,</span> <span class="n">Cube</span><span class="o">)</span> <span class="o">=</span> <span class="err">“</span><span class="n">black</span><span class="err">”</span> <span class="o">{}</span>
<span class="o">}</span></code></pre></figure>

<p>这个全属性例子包含了上面所有属性，在编辑器上展示的属性如下。</p>

<p><img src="/assets/book/7/shader9.png" alt="shader全属性"></p>

<p>注意，这里为什么属性前都要加一个”_”，这是个习惯性写法，没有任何强制性，只是大部分程序员在书写Shader属性变量的习惯，逐渐形成了一个传统。</p>

<p>如果硬要套个说法，那就只能是”_”代表内部变量。就像我们书写代码变量时会有一些小习惯和规则一样，没有其他影响。</p>

<h6>Property属性默认值</h6>

<p>每个Property属性都有一个默认值，默认值是必须填写的，否则Shader编译器不会通过编译。这里我们说明一下所有属性的默认值。</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    1，Number类型。Range，默认值必须在最大和最小值之间，比如Range(0,1)时值为默认值必须为0到1之间。Float，默认值可以为任意浮点数。Int，默认值可以为任意整数，且仅仅只能是整数，不能是浮点数。

    2，Color颜色类型。Color，默认值为4个浮点数，按照RGBA的顺序，第一个代表红色，第二个代表绿色，第三个代表蓝色，第四个代表透明度alpha。

    3，Vector方向坐标类型。Vector，默认值为4个浮点数，按照xyzw的顺序，第一个代表X坐标，第二个代表Y坐标，第三个代表Z坐标，第四个代表角度，深度等其他意义。Vector四个坐标完全可以代表任意值，比如前两个代表2D的X和Y，后面两个代表宽度和长度，再比如，前两个代表uv，后两个代表宽度和长度，或者比如前三个表示x，y，z，最后一个代表透明度alpha。

    4，2D Texture贴图类型。2D Texture，默认值有一个默认的颜色，”white”代表(RGBA:1,1,1,1)白色，”black”代表(RGBA:0,0,0,0)黑色，”gray”代表(RGBA:0.5,0.5,0.5,0.5)灰色，”bump”代表(RGBA:0.5,0.5,1,0.5)灰黄色，”red”代表(RGBA:1,0,0,0)红色。

    5，Cube，3D Texture，2DArray非2D贴图类型。默认值为空，当材质球编辑器中没有设置他们的实例时，他们使用灰色(RGBA:0.5,0.5,0.5,0.5)做默认值。
</code></pre></div>
<p>每个属性值的值在Material材质上都会被序列化后写入Material材质球的Meta文件。</p>

<p>Shader里实际上可以有很多参数，比如矩阵，数组等，但这些都需要在Shader实时运行中设置和获取的变量，不能成为Property的一部分，因为他们不是Property属性的一部分，也不会被记录存储在Mate文件里。</p>

<p>在Mate文件里的属性，我们不但可以通过Unity编辑器视窗中来赋值和变更，也可以通过脚本程序来赋值和改变，例如Material.SetFloat可以用来设置Shader中Float类型的属性，Material.SetColor用来设置Color类型的属性，Material. SetTexture可以用来设置 Texture类型的属性。</p>

<p>没有在Property中的属性类型或变量也同样可以使用Material.SetXXX(“PropertyName”,value)来设置，比如我们可以通过Material. SetMatrix设置矩阵类型在Shader中的变量，虽然矩阵没有在属性块中，我们照样可以设置，只要它在Shader程序变量中声明过就可以。</p>

<p>下面代码就是一个很好的例子：</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ExampleClass</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">rotateSpeed</span> <span class="p">=</span> <span class="m">30f</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Update</span> <span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Quaternion</span> <span class="n">rot</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">Euler</span> <span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">time</span> <span class="p">*</span> <span class="n">rotateSpeed</span><span class="p">);</span>
        <span class="n">Matrix4x4</span> <span class="n">m</span> <span class="p">=</span> <span class="n">Matrix4x4</span><span class="p">.</span><span class="n">TRS</span> <span class="p">(</span><span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">one</span><span class="p">);</span>
        <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Renderer</span><span class="p">&gt;().</span><span class="n">material</span><span class="p">.</span><span class="n">SetMatrix</span> <span class="p">(</span><span class="s">&quot;_TextureRotation&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">///// Shader部分</span>
<span class="n">Shader</span> <span class="s">&quot;RotatingTexture&quot;</span>
<span class="p">{</span>
    <span class="n">Properties</span>
    <span class="p">{</span>
        <span class="n">_MainTex</span> <span class="p">(</span><span class="s">&quot;Base (RGB)&quot;</span><span class="p">,</span> <span class="m">2D</span><span class="p">)</span> <span class="p">=</span> <span class="s">&quot;white&quot;</span> <span class="p">{}</span>
    <span class="p">}</span>
    <span class="n">SubShader</span>
    <span class="p">{</span>
        <span class="n">Pass</span>
        <span class="p">{</span>
            <span class="n">CGPROGRAM</span>
            <span class="cp">#pragma vertex vert</span>
            <span class="cp">#pragma fragment frag</span>

            <span class="k">struct</span> <span class="nc">v2f</span>
            <span class="p">{</span>
                <span class="n">float2</span> <span class="n">uv</span> <span class="p">:</span> <span class="n">TEXCOORD0</span><span class="p">;</span>
                <span class="n">float4</span> <span class="n">pos</span> <span class="p">:</span> <span class="n">SV_POSITION</span><span class="p">;</span>
            <span class="p">};</span>

            <span class="n">float4x4</span> <span class="n">_TextureRotation</span><span class="p">;</span>

            <span class="n">v2f</span> <span class="nf">vert</span> <span class="p">(</span><span class="n">float4</span> <span class="n">pos</span> <span class="p">:</span> <span class="n">POSITION</span><span class="p">,</span> <span class="n">float2</span> <span class="n">uv</span> <span class="p">:</span> <span class="n">TEXCOORD0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">v2f</span> <span class="n">o</span><span class="p">;</span>
                <span class="n">o</span><span class="p">.</span><span class="n">pos</span> <span class="p">=</span> <span class="n">UnityObjectToClipPos</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
                <span class="n">o</span><span class="p">.</span><span class="n">uv</span> <span class="p">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">_TextureRotation</span><span class="p">,</span> <span class="n">float4</span><span class="p">(</span><span class="n">uv</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)).</span><span class="n">xy</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">o</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">sampler2D</span> <span class="n">_MainTex</span><span class="p">;</span>
            <span class="n">fixed4</span> <span class="nf">frag</span> <span class="p">(</span><span class="n">v2f</span> <span class="n">i</span><span class="p">)</span> <span class="p">:</span> <span class="n">SV_Target</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nf">tex2D</span><span class="p">(</span><span class="n">_MainTex</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">uv</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">ENDCG</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>上述代码中，_TextureRotation 并不是Property属性块中的变量，SetMatrix也同样可以通过材质球实例在程序运行时进行设置。</p>

<p>这就告诉我们，程序运行时设置Shader中的变量，并不是一定要在Property属性块中声明的。</p>

<p>其他比如获取Material中的变量可以通过Material.GetXXX(“PropertyName”)来获得，比如Material. GetTexture，Material.GetColor，Material.GetFloat等等。关于Material的很多功能可以通过查看Material的API来了解，这里不再详细介绍。</p>

<h6>属性的Attributes特性和Drawers绘制工具</h6>

<p>在书写属性时可以加入一些特性来让属性的用途更加明显，属性的特性有如下：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    [HideInInspector] 在视窗中隐藏。

    [NoScaleOffse] 不显示贴图的tiling/offset属性。

    [Normal] 表明这张贴图是张法线贴图。

    [HDR] 表明这贴图是张高动态范围贴图。

    [Gamma] 表明这个Float或者Vector属性是个RGB类型的颜色，可能会需要转换成以符合的格式使用。

    [PerRendererData] 表明这张贴图每帧都会被MaterialPropertyBlock重新设置。
</code></pre></div>
<p>书写方式就是在属性前加入这些特性，如下：</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="n">Properties</span>
<span class="p">{</span>
<span class="na">    [HideInInspector]</span> <span class="n">_Scale</span> <span class="p">(</span><span class="s">&quot;Scale&quot;</span><span class="p">,</span> <span class="n">Range</span> <span class="p">(</span><span class="m">0.02</span><span class="p">,</span><span class="m">0.15</span><span class="p">))</span> <span class="p">=</span> <span class="m">0.07</span>
    <span class="n">_PahLength</span><span class="p">(</span><span class="s">&quot;Path Length&quot;</span><span class="p">,</span> <span class="n">Float</span><span class="p">)</span> <span class="p">=</span> <span class="m">1.5</span>
    <span class="n">_OrderNumber</span><span class="p">(</span><span class="s">&quot;Order Number&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">)</span> <span class="p">=</span> <span class="m">53</span>
<span class="na">    [Gamma]</span>  <span class="n">_RefrColor</span> <span class="p">(</span><span class="s">&quot;Refraction color&quot;</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="m">0.34</span><span class="p">,</span> <span class="m">0.85</span><span class="p">,</span> <span class="m">0.92</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> 
    <span class="n">_Direction</span> <span class="p">(</span><span class="s">&quot;Direction&quot;</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4.5</span><span class="p">,</span> <span class="m">1.2</span><span class="p">,</span> <span class="m">3.3</span><span class="p">)</span> 
<span class="na">    [NoScaleOffse]</span>  <span class="n">_RefractionTex</span> <span class="p">(</span><span class="s">&quot;Environment Refraction&quot;</span><span class="p">,</span> <span class="m">2D</span><span class="p">)</span> <span class="p">=</span> <span class="s">&quot;white&quot;</span> <span class="p">{}</span>
    <span class="n">_RefractionMap</span> <span class="p">(</span><span class="s">&quot;Refraction Map&quot;</span><span class="p">,</span> <span class="n">Cube</span><span class="p">)</span> <span class="p">=</span> <span class="err">“</span><span class="n">black</span><span class="err">”</span> <span class="p">{}</span>
<span class="p">}</span></code></pre></figure>

<p>Drawers绘制特性列举：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>    Drawer和Attribute的区别就是Drawer主要关注点在工具的绘制上，而不是对属性的限制。

    [Toggle] 表明此数字为开关类型，只有0，或1的选择。

    [Enum] 表明此变量只能从几个选项中选择。

    [KeywordEnum] 表明只能在选项中选择关键字，这个特性通常用在开关Shader的部分功能。

    [PowerSlider] 显示一个非线性的属性选择范围。

    [IntRange] 显示一个数字范围，这个数字范围内必须是整数。

    [Space] 在视窗中的属性前创建一个垂直的空隙。

    [Header] 在视窗的属性前展示一个文字说明。
</code></pre></div>
<p>例如下面的属性绘制特性</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><span></span><span class="n">Properties</span>
<span class="p">{</span>
<span class="na">        [PowerSlider]</span> <span class="n">_Scale</span> <span class="p">(</span><span class="s">&quot;Scale&quot;</span><span class="p">,</span> <span class="n">Range</span> <span class="p">(</span><span class="m">0.02</span><span class="p">,</span><span class="m">0.15</span><span class="p">))</span> <span class="p">=</span> <span class="m">0.07</span>
<span class="na">        [Space(100)]</span> <span class="n">_PahLength</span><span class="p">(</span><span class="s">&quot;Path Length&quot;</span><span class="p">,</span> <span class="n">Float</span><span class="p">)</span> <span class="p">=</span> <span class="m">1.5</span>
<span class="na">        [Toggle]</span> <span class="n">_OrderNumber</span><span class="p">(</span><span class="s">&quot;Order Number&quot;</span><span class="p">,</span> <span class="n">Int</span><span class="p">)</span> <span class="p">=</span> <span class="m">53</span>
<span class="na">        [Enum(small,1,big,2,huge,10)]</span> <span class="n">_Size</span> <span class="p">(</span><span class="s">&quot;size&quot;</span><span class="p">,</span> <span class="n">Float</span><span class="p">)</span> <span class="p">=</span> <span class="m">1</span>
        <span class="n">_Direction</span> <span class="p">(</span><span class="s">&quot;Direction&quot;</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">4.5</span><span class="p">,</span> <span class="m">1.2</span><span class="p">,</span> <span class="m">3.3</span><span class="p">)</span> 
<span class="na">        [Header(ok head)]</span> <span class="n">_RefractionTex</span> <span class="p">(</span><span class="s">&quot;Environment Refraction&quot;</span><span class="p">,</span> <span class="m">2D</span><span class="p">)</span> <span class="p">=</span> <span class="s">&quot;white&quot;</span> <span class="p">{}</span>
        <span class="n">_RefractionMap</span> <span class="p">(</span><span class="s">&quot;Refraction Map&quot;</span><span class="p">,</span> <span class="n">Cube</span><span class="p">)</span> <span class="p">=</span> <span class="s">&quot;black&quot;</span> <span class="p">{}</span>
<span class="p">}</span></code></pre></figure>

<p>绘制结果截图</p>

<p><img src="/assets/book/7/shader10.png" alt="Drawer绘制"> </p>

  <p>感谢您的耐心阅读</p>
  <p>Thanks for your reading</p>
</div>
<div>
  
<!-- 代码1：放在页面需要展示的位置  -->
<!-- 如果您配置过sourceid，建议在div标签中配置sourceid、cid(分类id)，没有请忽略  -->
<!-- <div id="cyReward" role="cylabs" data-use="reward" align="center" ></div> -->

<script type="text/javascript" src="/assets/js/tctip-1.0.3.min.js"></script>
<script>
  new tctip({
    top: '50%',
    button: {
      id: 9,
      type: 'zanzhu'
    },
    list: [
      {
        type: 'alipay',
        qrImg: '/assets/common/alipay.jpg'
      }, {
        type: 'wechat',
        qrImg: '/assets/common/wechatpay.jpg'
      }, {
        type: 'bitcoin',
        qrContent: '1ErCFmtoQY2KDctjgPALZri3USsMqdSvqh'
      }
    ]
  }).init()
</script>

  <li>
<p><strong><font color="red">版权申明</font></strong></p>
<!-- <p>本文为博主原创文章，未经允许不得转载: <a href = "http://www.luzexi.com">http://www.luzexi.com</a></p> -->
<p><strong><font color="red">本文为博主原创文章，未经允许不得转载:</font></strong></p>
<p><a href = "http://www.luzexi.com/2018/08/07/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader2.html">《Unity3D高级编程之进阶主程》第七章，Shader(二) - Property</a></p>
<!-- <p>本文为博主原创文章，未经允许不得转载: <a href = "http://www.luzexi.com/2018/08/07/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader2.html">《Unity3D高级编程之进阶主程》第七章，Shader(二) - Property</a></p> -->
<p><strong><font color="red">Copyright attention</font></strong></p>
<p><strong><font color="red">Please don't reprint without authorize.</font></strong></p>

</li>
  <li>
<p><strong>微信公众号</strong></p>
<p><image src="/public/qrcode_for_gzh.jpg" /></p>
</li>
</div>
<div class="related">
    
<div class="bshare-custom icon-medium-plus"><div class="bsPromo bsPromo2"></div><a title="分享到微信" class="bshare-weixin" href="javascript:void(0);"></a><a title="分享到新浪微博" class="bshare-sinaminiblog"></a><a title="分享到QQ好友" class="bshare-qqim" href="javascript:void(0);"></a><a title="分享到QQ空间" class="bshare-qzone" href="javascript:void(0);"></a><a title="分享到Twitter" class="bshare-twitter" href="javascript:void(0);"></a><a title="分享到Facebook" class="bshare-facebook" href="javascript:void(0);"></a><a title="更多平台" class="bshare-more bshare-more-icon more-style-addthis"></a></div><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#style=-1&amp;uuid=36b4f383-d948-41a3-acd5-31ae604e3ad8&amp;pophcol=2&amp;lang=zh"></script><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/bshareC0.js"></script>


</div>



<script type="text/javascript">
	if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent))
    { //移动端
        /*mobile-20:5*/
    	var cpro_id = "u3493987";
		document.write("\<script type=\"text\/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/cm.js\"\>\<\/script\>");
    }
    else
    {
        /*760*90 创建于 2016-02-02*/
    	var cpro_id = "u2514412";
        document.write("\<script type=\"text/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/c.js\"\>\<\/script\>");
	}
</script>





<div class="related">
  <h2>最新发表的文章</h2>
  <ul class="related-posts">

    
      <li>
        <h3>
          <a href="/2018/11/03/%E6%80%9D%E8%B7%AF%E6%8E%A2%E8%AE%A89.html">
            思路探讨(九)
            <small>03 Nov 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/10/20/%E6%80%9D%E8%B7%AF%E6%8E%A2%E8%AE%A88.html">
            思路探讨(八)
            <small>20 Oct 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2018/10/14/%E7%99%BD%E9%A2%86%E6%8A%95%E8%B5%84%E6%8E%A2%E8%AE%A87.html">
            白领投资探讨(七)
            <small>14 Oct 2018</small>
          </a>
        </h3>
      </li>
    

  </ul>

  <h2>之后发表的文章</h2>

  <ul class="related-posts">
    

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      

    

      
      

      
        
          <li>
            <h3>
              <a href="/2018/08/13/%E7%99%BD%E9%A2%86%E6%8A%95%E8%B5%84%E6%8E%A2%E8%AE%A84.html">
                白领投资探讨(四)
                <small>13 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/08/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader6.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(六) - Pass(三)Blend
                <small>08 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/08/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader5.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(五) - Pass(二)
                <small>08 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/08/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader4.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(四) - Pass(一)
                <small>08 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/08/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader3.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(三) - 渲染管道
                <small>08 Aug 2018</small>
              </a>
            </h3>
          </li>
        

        
  <!-- </ul> -->

  <h2>之前发表的文章</h2>

  <ul class="related-posts">
    

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      

    

      

      
        
          <li>
            <h3>
              <a href="/2018/08/07/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-%E7%BD%91%E7%BB%9C%E5%B1%822.html">
                《Unity3D高级编程之进阶主程》第六章，网络层(二) - 实现TCP
                <small>07 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/07/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader2.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(二) - Property
                <small>07 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/07/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-Shader1.html">
                《Unity3D高级编程之进阶主程》第七章，Shader(一) - 常用的Shader
                <small>07 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/06/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-%E7%BD%91%E7%BB%9C%E5%B1%821.html">
                《Unity3D高级编程之进阶主程》第六章，网络层(一) - TCP还是UDP
                <small>06 Aug 2018</small>
              </a>
            </h3>
          </li>
        
          <li>
            <h3>
              <a href="/2018/08/06/Unity3D%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B%E4%B9%8B%E8%BF%9B%E9%98%B6%E4%B8%BB%E7%A8%8B-3D%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%8A%A8%E7%94%BB3.html">
                《Unity3D高级编程之进阶主程》第五章，3D模型与动画(三) - 状态机
                <small>06 Aug 2018</small>
              </a>
            </h3>
          </li>
        

        
  </ul>
</div>




<div id="SOHUCS" ></div>
<script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js" ></script>
<script type="text/javascript">
window.changyan.api.config({
appid: 'cys17tiy3',
conf: 'prod_3b20e80a06c760385d4781c30f8ebf5c'
});
</script>


<!-- 代码2：用来读取评论框配置，此代码需放置在代码1之后。 -->
<!-- 如果当前页面有评论框，代码2请勿放置在评论框代码之前。 -->
<!-- 如果页面同时使用多个实验室项目，以下代码只需要引入一次，只配置上面的div标签即可 -->
<script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="https://changyan.sohu.com/js/changyan.labs.https.js?appid=cys17tiy3"></script>


<script type="text/javascript">
	if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent))
    { //移动端
        /*mobile-悬浮20:3*/
    	var cpro_id = "u3495898";
		document.write("\<script type=\"text\/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/cm.js\"\>\<\/script\>");
    }
    else
    {
        /*500*200-1*/
        var cpro_id = "u3486033";
        document.write("\<script type=\"text/javascript\" src=\"//cpro.baidustatic.com/cpro/ui/c.js\"\>\<\/script\>");
	}
</script>
 



    </div>

    
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?f3d58556a7396e715b3602ef6754cd91";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


    <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

  </body>
  
</html>
