<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title> 游戏引擎架构#4 低阶渲染器（1） - 技术人生</title><link rel="shortcut icon" href="/public/favicon.ico"><link rel="alternate" type="application/atom+xml" title="技术人生" href="/atom.xml"><link rel="alternate" type="application/json" title="技术人生" href="http://www.luzexi.com/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:"Arial","Microsoft YaHei","黑体","宋体",sans-serif, system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1.4rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:13rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:bold;line-height:1.25;color:#313131;text-rendering:optimizeLegibility}h1{font-size:3rem}h2{margin-top:1rem;font-size:1.9rem}h3{margin-top:1.5rem;font-size:1.6rem}h4,h5,h6{margin-top:1rem;font-size:1.4rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:100rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.static_post{position:relative;padding-bottom:56.25%;padding-top:35px;height:0;overflow:hidden}.static_post iframe{position:absolute;top:0;left:0;width:100%;height:100%}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">技术人生</h1>--><nav role="navigation"><ul><li><a href="/" >主页</a></li><li><a href="/about" >关于我</a></li><li><a href="/search" >文章搜索</a></li><li><a href="/tag/书籍著作/" >书籍著作</a></li><li><a href="/tag/Unity3D/" >Unity3D</a></li><li><a href="/tag/图解游戏引擎/" >图解游戏引擎</a></li><li><a href="/tag/游戏通用模块/" >游戏通用模块</a></li><li><a href="/tag/前端技术/" >前端技术</a></li><li><a href="/tag/后端技术/" >后端技术</a></li><li><a href="/tag/其他技术/" >其他技术</a></li><li><a href="/tag/金融投资/" >金融投资</a></li><li><a href="/tag/life/" >思路探讨</a></li><li><a href="/tag/英文文章/" >英文文章</a></li><li><a href="/tag/读书笔记/" >读书笔记汇总</a></li><li><a href="/tag/演讲/" >演讲</a></li><li><a href="/tag/给女儿写信/" >给女儿写信</a></li><li><a href="/engineer-shopping" >成长必需品</a></li><li><a href="/friendlink" >友情链接</a></li><li><a href="/atom.xml" >Rss</a></li><li><a href="https://github.com/luzexi" >GitHub</a></li></ul></nav></header><section class="post"><h2>游戏引擎架构#4 低阶渲染器（1）</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzU1ODY1ODY2NA==&amp;mid=2247484964&amp;idx=1&amp;sn=99fd35baa5ad829cbae99753f14aa64b&amp;chksm=fc226323cb55ea3598d74dd2508841f01e149176b2c857c54c077a2d8a3f493033ce8f57b56f&amp;token=1534435063&amp;lang=zh_CN#rd">已发布在微信公众号上，点击跳转</a></p><h2 id="背景">背景：</h2><p>作为游戏开发从业者，从业务到语言到框架到引擎，积累了一些知识和经验，特别是在看了几遍《游戏引擎架构》后对引擎架构的理解又深入了些。</p><p>近段时间有对引擎剖析的想法，正好借这书本对游戏引擎架构做一个完整分析。</p><p>此书用简明、清楚的方式覆盖了游戏引擎架构的庞大领域，巧妙地平衡了广度与深度，并且提供了足够的细节。</p><p>我将借助《游戏引擎架构》这本书、结合引擎源码和自己的经验，深入分析游戏引擎的历史、架构、模块，最后通过实践简单引擎开发来完成对引擎知识的掌握。</p><p>游戏引擎知识面深而广，所以对这系列的文章书编写范围做个保护，即不对细节进行过多的阐述，重点剖析的是架构、流程以及模块的运作原理。</p><p>同时《游戏引擎架构》中部分知识太过陈旧的部分，会重新深挖后总结出自己的观点。</p><h2 id="概述">概述：</h2><p>本系列文章对引擎中的重要的模块和库进行详细的分析，我挑选了十五个库和模块来分析：</p><ol><li>时间库</li><li>自定义容器库</li><li>字符串散列库</li><li>内存管理框架</li><li>RTTI与反射模块</li><li>图形计算库</li><li>资产管理模块</li><li>低阶渲染器</li><li>剔除与合批模块</li><li>动画模块</li><li>物理模块</li><li>UI底层框架</li><li>性能剖析器的核心部分</li><li>脚本系统</li><li>视觉效果模块</li></ol><p>本篇内容为列表中的第8个部分。</p><h2 id="正文">正文：</h2><p>简单回顾下前文</p><p>前文简单提了下C++编译过程、C++内存布局、文件内核读取原理、图形计算的常用库内容，以及大篇幅的引擎资产管理。</p><p>引擎资产管理简单回顾下：</p><p>首先，资产分为DCC资产、中间格式资产、引擎资产，这三者是从制作到导入到使用的顺序。</p><p>其次，引擎资产分为元数据和引擎资产文件，引擎不仅需要资产也需要资产的配置数据。</p><p>接着，引擎内存中的资产有资源映射关系，资产路径、资产GUID、资产实例、资产实例ID。</p><p>最后，引擎通常都有资源包，资源包的格式通常都差不多，头信息（包括索引信息和数据概要信息）+数据文件，压缩可以是整体压缩也可以是每个独立数据单独压缩，通过解剖资源包的数据格式，我们可以知道如何去做差量更新。</p><p>这里补充一点，引擎在读取资产时，与读取资产配置的原理是一样的，它可以有自己的数据格式也可以用标准格式，引擎通常使用自定义格式。通过区分读取不同类型的资产数据来实例化引擎内不同的资源对象，包括网格、材质、动画、粒子、节点、组件配置等。</p><h3 id="下面我们开始这篇内容">下面我们开始这篇内容</h3><p>本次内容会围绕GPU来写，从硬件架构到软件驱动再到引擎架构，目标是帮大家理解GPU硬件的运作原理，理解图形接口的架构，理解引擎低阶渲染器的架构。</p><h2 id="目录">目录：</h2><ol><li>主板结构中的显卡</li><li>GPU功能发展史</li><li>GPU与CPU的差异</li><li>GPU硬件特点</li><li>图形驱动程序架构</li><li>引擎低阶渲染架构</li></ol><h2 id="主板结构中的显卡">主板结构中的显卡</h2><p>我们讨论GPU和显卡时经常混为一谈，严格来说GPU是显卡（Video card、Display card、Graphics card）最核心的部件。 显卡除了GPU，还有扇热器、通讯元件、与主板和显示器连接的各类插槽。</p><p>图1</p><p>（主板结构图）</p><p>早期计算机设备中的CPU都是由系统总线来与所有其他设备通信，当图形芯片需要跟CPU和内存大量交换数据时就出现了巨大瓶颈，于是人们设计了高速的北桥芯片和低速的南桥芯片，一来协调CPU、内存、图形设备之间的高速通信，二来专门处理磁盘、USB、键盘鼠标等低速设备。</p><p>从上图中我们看到，离CPU越近，存取数据越快，最近的就是CPU内的组件了，其次是高速缓存总线，再是本地总线，接着是内存总线，最后是高速总线。 我们的GPU被安排在高速总线上，而且总线还有其他设备需要兼顾。因此从通信速度上来说，高速总线并不是那么快，这也是CPU与GPU的通信带宽通常成为瓶颈的其中一个原因。</p><p>图1</p><p>（现实中主板结构图：图片来自网络）</p><p>这里重点介绍下北桥芯片，一个主板上最重要的部分可以说就是主板的芯片组了，主板的芯片组一般由北桥芯片和南桥芯片组成，两者共同组成主板的芯片组。北桥芯片主要负责实现与CPU、内存、AGP接口之间的数据传输，同时还通过特定的数据通道和南桥芯片相连接。南桥芯片主要负责和IDE设备、PCI设备、声音设备、网络设备以及其他的I/O设备的通信。</p><p>主板和CPU发展都现在，北桥芯片慢慢开始消失被集成了CPU中。往后发展，主板芯片组可以看成是以往南桥芯片组的加强版，CPU与主板芯片采用DMI总线进行通信。</p><p>虽然从Lynnfield Core i5/i7开始把北桥集成到CPU上，但是其内部仍是采用QPI总线来通讯，而外部与主板芯片组通讯，其实就是以往主板上南桥与北桥通讯，采用的是DMI总线。因此不能说Lynnfield Core i5/i7是精简了，只是集成度更高而已。</p><h3 id="手机主板结构与pc不同">手机主板结构与PC不同</h3><p>以下图片均来源网络</p><p>图1</p><p>图2</p><p>图3</p><p>图4</p><p>手机的主板布局则不同，由于主板不能横向扩展，所以采用双或三层叠层的主板，GPU内嵌在处理器上与CPU同框，且它们周围布满了内存，这样通信更快。 同时由于空间小，功率和高速缓存大小也受到限制。</p><p>多层主板虽然看上去设计巧妙，同时也将几个发热大户都贴在了一起，发热量和速度加倍。</p><p>现代CPU都有一种过热自动降频或者关闭核心的保护措施，因此当玩王者或吃鸡等大型游戏时，就会因为发热而导致它更快的达到阈值温度而降频，这也是很多游戏优化后仍然会卡顿的主要原因。</p><p>因此很多手机引入了水冷（热导管技术）CPU散热技术，用超大一块热导管来散热降温，让CPU不会因为过热而降频或锁核，从而能更长时间甚至全时运行在最大工作频率上，从而发挥出手机宣传时100%的性能。</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzU1ODY1ODY2NA==&amp;mid=2247484964&amp;idx=1&amp;sn=99fd35baa5ad829cbae99753f14aa64b&amp;chksm=fc226323cb55ea3598d74dd2508841f01e149176b2c857c54c077a2d8a3f493033ce8f57b56f&amp;token=1534435063&amp;lang=zh_CN#rd">已发布在微信公众号上，点击跳转</a></p><h2 id="参考资料">参考资料：</h2><p>《主板北桥百科》</p><p>https://baike.baidu.com/item/%E4%B8%BB%E6%9D%BF%E5%8C%97%E6%A1%A5/10252486?fr=aladdin</p><p>《总线百科》</p><p>https://baike.baidu.com/item/%E6%80%BB%E7%BA%BF/108823</p><p>《iPhone 11/Pro Max内部结构示意图》</p><p>http://www.itqianyan.com/m/view.php?aid=5479</p><p>《拆解 iPhone 12 系列》</p><p>https://www.igao7.com/news/202010/L2RP34HNtTEZ2yYC.html</p><p>《iPhone 8和X拆解》</p><p>https://m.iphonediule.com/hot/qiangxian.html</p><span class="meta"><time datetime="2021-10-26T00:00:00+08:00">October 26, 2021</time> &middot; <a href="/tag/读书笔记">读书笔记</a>, <a href="/tag/前端技术">前端技术</a>, <a href="/tag/图解游戏引擎">图解游戏引擎</a></span> <!--<span class="meta"><time datetime="2021-10-26T00:00:00+08:00">October 26, 2021</time> &middot; <a class="post" href="/tag/读书笔记">读书笔记</a>, <a class="post" href="/tag/前端技术">前端技术</a>, <a class="post" href="/tag/图解游戏引擎">图解游戏引擎</a></span> --><div><p /><p>感谢您的耐心阅读</p><p>Thanks for your reading</p><p /> <script type="text/javascript" src="/assets/js/tctip-1.0.3.min.js"></script> <script> new tctip({ top: '50%', button: { id: 9, type: 'zanzhu' }, list: [ { type: 'alipay', qrImg: '/assets/common/alipay.jpg' }, { type: 'wechat', qrImg: '/assets/common/wechatpay.jpg' }, { type: 'bitcoin', qrContent: '1ErCFmtoQY2KDctjgPALZri3USsMqdSvqh' } ] }).init() </script><li><p><strong><font color="red">版权申明</font></strong></p><p><strong><font color="red">本文为博主原创文章，未经允许不得转载:</font></strong></p><p><a href = "http://www.luzexi.com/2021/10/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B047">游戏引擎架构#4 低阶渲染器（1）</a></p><p><strong><font color="red">Copyright attention</font></strong></p><p><strong><font color="red">Please don't reprint without authorize.</font></strong></p></li><li><p></p><p></p><p><image src="/public/qrcode_for_gzh.jpg" width="344" height="344" /></p><p><strong>微信公众号，文章同步推送，致力于分享一个资深程序员在北上广深拼搏中对世界的理解</strong></p><p></p><p></p><p>QQ交流群: 777859752 (高级程序书友会)</p></li></div><p /><div class="related"><div class="bshare-custom icon-medium-plus"><div class="bsPromo bsPromo2"></div><a title="分享到微信" class="bshare-weixin" href="javascript:void(0);"></a><a title="分享到新浪微博" class="bshare-sinaminiblog"></a><a title="分享到QQ好友" class="bshare-qqim" href="javascript:void(0);"></a><a title="分享到QQ空间" class="bshare-qzone" href="javascript:void(0);"></a><a title="分享到Twitter" class="bshare-twitter" href="javascript:void(0);"></a><a title="分享到Facebook" class="bshare-facebook" href="javascript:void(0);"></a><a title="更多平台" class="bshare-more bshare-more-icon more-style-addthis"></a></div><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#style=-1&amp;uuid=36b4f383-d948-41a3-acd5-31ae604e3ad8&amp;pophcol=2&amp;lang=zh"></script><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/bshareC0.js"></script></div><p /><div class="related"><h2>最新发表的文章</h2><ul class="related-posts"><li><h3> <a href="/2023/09/27/%E5%9B%BE%E8%A7%A3%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E-%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8A%80%E6%9C%AF2"> 图解游戏引擎 - 虚拟机技术（2） <small>27 Sep 2023</small> </a></h3></li><li><h3> <a href="/2023/08/25/%E5%9B%BE%E8%A7%A3%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E-%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8A%80%E6%9C%AF1"> 图解游戏引擎 - 虚拟机技术（1） <small>25 Aug 2023</small> </a></h3></li><li><h3> <a href="/2023/08/10/%E5%9B%BE%E8%A7%A3%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E-Unity%E7%9A%84UGUI%E5%8E%9F%E7%90%863"> 图解游戏引擎 - Unity引擎的UGUI原理（3） <small>10 Aug 2023</small> </a></h3></li></ul><h2 color='blue' >之后发表的文章</h2><ul class="related-posts"><li><h3> <a href="/2021/11/27/%E7%BB%99%E5%A5%B3%E5%84%BF%E7%9A%84%E4%BF%A119"> 给女儿写信(十九) 说出自己的感受积极化解情绪 <small>27 Nov 2021</small> </a></h3></li><li><h3> <a href="/2021/11/22/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B050"> 游戏引擎架构#4 低阶渲染器（3） <small>22 Nov 2021</small> </a></h3></li><li><h3> <a href="/2021/11/08/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B048"> 游戏引擎架构#4 低阶渲染器（2） <small>08 Nov 2021</small> </a></h3></li><li><h3> <a href="/2021/11/01/%E7%BB%99%E5%A5%B3%E5%84%BF%E7%9A%84%E4%BF%A118"> 给女儿写信(十八) 面对困难时该如何去做 <small>01 Nov 2021</small> </a></h3></li><li><h3> <a href="/2021/10/29/%E7%BB%99%E5%A5%B3%E5%84%BF%E7%9A%84%E4%BF%A117"> 给女儿写信(十七) 在挫折中前进 <small>29 Oct 2021</small> </a></h3></li><h2>之前发表的文章</h2><ul class="related-posts"><li><h3> <a href="/2021/10/17/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B046"> 读书笔记(四十六) 《如何精彩演讲》#1 演讲的结构 <small>17 Oct 2021</small> </a></h3></li><li><h3> <a href="/2021/10/12/%E6%80%9D%E8%B7%AF%E6%8E%A2%E8%AE%A866"> 思路探讨(六十六) 人和事 <small>12 Oct 2021</small> </a></h3></li><li><h3> <a href="/2021/09/28/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B045"> 游戏引擎架构#3 链接、图形计算库、资产管理模块 <small>28 Sep 2021</small> </a></h3></li><li><h3> <a href="/2021/09/22/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B044"> 读书笔记(四十四) 《心流》#3 专注时人们的表现 <small>22 Sep 2021</small> </a></h3></li><li><h3> <a href="/2021/09/17/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B043"> 游戏引擎架构#2 容器、内存、RTTI与反射 <small>17 Sep 2021</small> </a></h3></li></ul></div></section></main><script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "//hm.baidu.com/hm.js?f3d58556a7396e715b3602ef6754cd91"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script></body></html>
