---
layout: post
status: publish
published: false
title: 《Unity3D高级编程之进阶主程》第七章，渲染管线与图形学(五) - Projector投影原理以及PBR原理
description: "unity3d 高级编程 主程 shader 漫反射 镜面反射 自发光 球面反射"
excerpt_separator: ===
tags:
- 书籍著作
- Unity3D
- 前端技术
---

### Projector 投影的原理与应用

先确定有一个视体的范围，立方体或视锥体，遍历并计算出视体范围内的物体，取出物体，并计算投影矩阵，将投影矩阵传入Shader中，对物体再渲染一次。

在Shader中，结合传入的投影矩阵，将顶点转为 Projector 投影空间中。

这个转化后的投影空间中的坐标，也就是我们常说的"投影纹理坐标"，"投影纹理坐标"不能当作uv来作为纹理坐标来使用，需要调用 tex2Dproj 方法来获取纹理坐标，

		tex2Dproj(texture,uvproj);

		这个纹理投影函数，其实就是在使用之前会将该投影纹理坐标除以透视值

		可以等价于按如下方法使用普通二维纹理查询函数

    	float4 uvproj = uvproj/uvproj.w;

    	tex2D(texture,uvproj);

如果只是单纯的投影，不做任何处理，那么就只是将一整块贴图，贴在模型上而已，并且是整个模型平铺的方式。

如果不想以平铺全模型的方式，则要另想办法，比如绘制一个box，但纹理的展示方式则以深度信息为依据。

大致的方向是，以一个BOX为渲染对象，渲染时，在片元着色器中重新判定渲染纹理与渲染坐标。怎么判定呢？先从顶点着色器上获得顶点坐标的屏幕坐标，在片元着色器中传入的屏幕坐标时成了片元在屏幕上的坐标，用屏幕坐标获取对应的深度值，再让深度值作为z坐标来形成一个三维坐标，这时三维坐标只是屏幕空间上的坐标，我们让其屏幕空间转换到相机空间，再从相机空间转换到世界空间，再转换到投影空间，这样坐标就到了投影空间，再除以透视值，就得到坐标在0-1范围的坐标值，用这个值去提取纹理上的颜色，最后用这个颜色绘制片元。

### 什么是PBR，现在为什么对PBR如此重视

PBR管线不是仅仅是为了画面上的效果，更为了大量重复工作规定了规范可流水线操作。

### Light probe 原理与应用

用 Spherical Harmonics basis 数据存储在Light probe上，运动物体会与最近的 Light probe 点计算光照。

### 什么是渲染管线的升级，为什么要升级渲染管线

SPR(Scriptable Render Pipeline)可编程管线，什么是高自定义管线HDRP(High-Definition Rendering Pipeline)，Unity3D中的轻量渲染管线LWRP与传统管线有什么差别，以及最近升级的通用管线

### Entity 数据栈的原理与应用

### Lua 原理

### IL 原理与注入，以及Mono VM，IL2CPP，Burst的区别于介绍



### Texture Array

多个数组被传入Shader，其实和 GPU Instancing 是同一个道理。

### Graphics Command Buffers

### High Dynamic Range 是什么？

### 闪烁的根源：坐标系变化后的z精度问题

### 什么是Overdraw，怎么解决Overdraw问题

### 什么是卷积，卷积对后渲染的作用

### 2幂次纹理的读取与纹理压缩

<!-- ### 为什么要用CG来写Shader而不是其他的 -->
